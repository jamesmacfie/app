'use strict';Router.globalSubscription = new SubsManager();Router.configure({	loadingTemplate: 'loading',	notFoundTemplate: 'notFound',	onBeforeAction: function() {		FlashMessages.clear();		var unauthUrls = ['/login', '/signUp'];		if (Meteor.isClient) {			if (!Meteor.userId() && unauthUrls.indexOf(this.url) === -1) {				Router.go('login');			} else if (!Meteor.userId()) {				this.next();			} else {				var mainMenu = $('.js-mainMenu'),					overlay = $('.js-mainMenuOverlay');				// Ensure we always hide the menu on route change				mainMenu.removeClass('isVisible');				overlay.hide();				this.layout('layout');				this.next();			}		} else {			this.next();		}	},	waitOn: function() {		if (Meteor.userId()) {			return [				Router.globalSubscription.subscribe('userNetworks'),				Router.globalSubscription.subscribe('userHubs'),				Router.globalSubscription.subscribe('userRooms'),				Router.globalSubscription.subscribe('userImages'),				Router.globalSubscription.subscribe('userHubSensors'),				Router.globalSubscription.subscribe('userDataPoints'),				Router.globalSubscription.subscribe('sensorTypes')			];		}	}});