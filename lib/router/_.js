'use strict';Router.globalSubscription = new SubsManager();Router.configure({	loadingTemplate: 'loading',	notFoundTemplate: 'notFound',	onBeforeAction: function() {		var unauthUrls = ['/login'];		if (Meteor.isClient) {			if (!Meteor.userId() && unauthUrls.indexOf(this.url) === -1) {				FlashMessages.sendWarning('Please login first.');				Router.go('login');			} else if (!Meteor.userId()) {				this.next();			} else {				this.layout('layout');				// Ensure we always hide the menu on route change				$('#pageHolder').removeClass('menuActive');				this.next();			}		} else {			this.next();		}	},	waitOn: function() {		if (Meteor.userId()) {			return [				Router.globalSubscription.subscribe('userNetworks'),				Router.globalSubscription.subscribe('userRooms'),				Router.globalSubscription.subscribe('userImages'),				Router.globalSubscription.subscribe('userHubSensors'),				Router.globalSubscription.subscribe('userDataPoints'),				Router.globalSubscription.subscribe('sensorTypes')			];		}	}});